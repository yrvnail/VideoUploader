/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/extend","sap/ui/core/Component"],function(L,e,C){"use strict";return{_routeMatched:function(a,s,n){var r=this._oRouter,t,T,c,E,v=null,o=null,i,b,d,A;r._stopWaitingTitleChangedFromChild();r._oMatchedRoute=this;r._bMatchingProcessStarted=true;c=e({},r._oConfig,this._oConfig);T=r.getTargets();var f;if(T){f=T._getTitleTargetName(c.target,c.titleTarget);if(f&&r._oPreviousTitleChangedRoute!==this){r._bFireTitleChanged=true;if((r._oOwner&&r._oOwner._bRoutingPropagateTitle)){var p=C.getOwnerComponentFor(r._oOwner);var P=p&&p.getRouter();if(P){P._waitForTitleChangedOn(r);}}}else{r._bFireTitleChanged=false;}if(this._oConfig.target){A=T._alignTargetsInfo(this._oConfig.target);A.forEach(function(t){t.propagateTitle=t.hasOwnProperty("propagateTitle")?t.propagateTitle:r._oConfig.propagateTitle;t.routeRelevant=true;});}}else{A=this._oConfig.target;}if(!s||s===true){i=true;s=Promise.resolve();}if(this._oParent){s=this._oParent._routeMatched(a,s);}else if(this._oNestingParent){this._oNestingParent._routeMatched(a,s,this);}b=Object.assign({},a);b.routeConfig=c;E={name:c.name,arguments:a,config:c};if(n){E.nestedRoute=n;}this.fireBeforeMatched(E);r.fireBeforeRouteMatched(E);if(this._oTarget){t=this._oTarget;t._updateOptions(this._convertToTargetOptions(c));s=t._place(s);if(this._oRouter._oTargetHandler&&this._oRouter._oTargetHandler._chainNavigation){d=s;s=this._oRouter._oTargetHandler._chainNavigation(function(){return d;});}}else{s=r._oTargets._display(A,b,this._oConfig.titleTarget,s);}return s.then(function(R){r._bMatchingProcessStarted=false;var g,V,h;if(Array.isArray(R)){g=R;R=g[0];}R=R||{};v=R.view;o=R.control;E.view=v;E.targetControl=o;if(g){V=[];h=[];g.forEach(function(R){V.push(R.view);h.push(R.control);});E.views=V;E.targetControls=h;}if(c.callback){c.callback(this,a,c,o,v);}this.fireEvent("matched",E);r.fireRouteMatched(E);if(i){L.info("The route named '"+c.name+"' did match with its pattern",this);this.fireEvent("patternMatched",E);r.fireRoutePatternMatched(E);}return R;}.bind(this));}};});
