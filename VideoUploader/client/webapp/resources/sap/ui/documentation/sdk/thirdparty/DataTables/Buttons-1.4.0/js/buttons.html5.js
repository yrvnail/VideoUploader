/*!
 * HTML5 export buttons for Buttons and DataTables.
 * 2016 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (1.3.3) - MIT license
 * Copyright © 2016 Eli Grey - http://eligrey.com
 */
(function(f){if(typeof define==='function'&&define.amd){define(['jquery','datatables.net','datatables.net-buttons'],function($){return f($,window,document);});}else if(typeof exports==='object'){module.exports=function(r,$,j,p){if(!r){r=window;}if(!$||!$.fn.dataTable){$=require('datatables.net')(r,$).$;}if(!$.fn.dataTable.Buttons){require('datatables.net-buttons')(r,$);}return f($,r,r.document,j,p);};}else{f(jQuery,window,document);}}(function($,w,c,f,p,u){'use strict';var D=$.fn.dataTable;function _(){return f||w.JSZip;}function g(){return p||w.pdfMake;}var h=(function(a){"use strict";if(typeof a==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return;}var d=a.document,b=function(){return a.URL||a.webkitURL||a;},s=d.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in s,j=function(i){var N=new MouseEvent("click");i.dispatchEvent(N);},n=/constructor/i.test(a.HTMLElement)||a.safari,C=/CriOS\/[\d]+/.test(navigator.userAgent),E=function(i){(a.setImmediate||a.setTimeout)(function(){throw i;},0);},F="application/octet-stream",G=1000*40,H=function(i){var N=function(){if(typeof i==="string"){b().revokeObjectURL(i);}else{i.remove();}};setTimeout(N,G);},I=function(N,O,P){O=[].concat(O);var i=O.length;while(i--){var Q=N["on"+O[i]];if(typeof Q==="function"){try{Q.call(N,P||N);}catch(R){E(R);}}}},J=function(i){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)){return new Blob([String.fromCharCode(0xFEFF),i],{type:i.type});}return i;},K=function(i,N,O){if(!O){i=J(i);}var P=this,Q=i.type,R=Q===F,S,T=function(){I(P,"writestart progress write writeend".split(" "));},U=function(){if((C||(R&&n))&&a.FileReader){var V=new FileReader();V.onloadend=function(){var X=C?V.result:V.result.replace(/^data:[^;]*;/,'data:attachment/file;');var Y=a.open(X,'_blank');if(!Y)a.location.href=X;X=u;P.readyState=P.DONE;T();};V.readAsDataURL(i);P.readyState=P.INIT;return;}if(!S){S=b().createObjectURL(i);}if(R){a.location.href=S;}else{var W=a.open(S,"_blank");if(!W){a.location.href=S;}}P.readyState=P.DONE;T();H(S);};P.readyState=P.INIT;if(e){S=b().createObjectURL(i);setTimeout(function(){s.href=S;s.download=N;j(s);T();H(S);P.readyState=P.DONE;});return;}U();},L=K.prototype,M=function(i,N,O){return new K(i,N||i.name||"download",O);};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(i,N,O){N=N||i.name||"download";if(!O){i=J(i);}return navigator.msSaveOrOpenBlob(i,N);};}L.abort=function(){};L.readyState=L.INIT=0;L.WRITING=1;L.DONE=2;L.error=L.onwritestart=L.onprogress=L.onwrite=L.onabort=L.onerror=L.onwriteend=null;return M;}(typeof self!=="undefined"&&self||typeof w!=="undefined"&&w||this.content));D.fileSave=h;var k=function(a){var s='Sheet1';if(a.sheetName){s=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,'');}return s;};var l=function(a){return a.newline?a.newline:navigator.userAgent.match(/Windows/)?'\r\n':'\n';};var m=function(d,b){var n=l(b);var e=d.buttons.exportData(b.exportOptions);var j=b.fieldBoundary;var C=b.fieldSeparator;var E=new RegExp(j,'g');var F=b.escapeChar!==u?b.escapeChar:'\\';var G=function(a){var s='';for(var i=0,K=a.length;i<K;i++){if(i>0){s+=C;}s+=j?j+(''+a[i]).replace(E,F+j)+j:a[i];}return s;};var H=b.header?G(e.header)+n:'';var I=b.footer&&e.footer?n+G(e.footer):'';var J=[];for(var i=0,K=e.body.length;i<K;i++){J.push(G(e.body[i]));}return{str:H+J.join(n)+I,rows:J.length};};var o=function(){var s=navigator.userAgent.indexOf('Safari')!==-1&&navigator.userAgent.indexOf('Chrome')===-1&&navigator.userAgent.indexOf('Opera')===-1;if(!s){return false;}var a=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);if(a&&a.length>1&&a[1]*1<603.1){return true;}return false;};function q(n){var a='A'.charCodeAt(0);var b='Z'.charCodeAt(0);var d=b-a+1;var s="";while(n>=0){s=String.fromCharCode(n%d+a)+s;n=Math.floor(n/d)-1;}return s;}try{var r=new XMLSerializer();var v;}catch(t){}function x(a,b){if(v===u){v=r.serializeToString($.parseXML(A['xl/worksheets/sheet1.xml'])).indexOf('xmlns:r')===-1;}$.each(b,function(n,d){if($.isPlainObject(d)){var e=a.folder(n);x(e,d);}else{if(v){var j=d.childNodes[0];var i,s;var C=[];for(i=j.attributes.length-1;i>=0;i--){var E=j.attributes[i].nodeName;var F=j.attributes[i].nodeValue;if(E.indexOf(':')!==-1){C.push({name:E,value:F});j.removeAttribute(E);}}for(i=0,s=C.length;i<s;i++){var G=d.createAttribute(C[i].name.replace(':','_dt_b_namespace_token_'));G.value=C[i].value;j.setAttributeNode(G);}}var H=r.serializeToString(d);if(v){if(H.indexOf('<?xml')===-1){H='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+H;}H=H.replace(/_dt_b_namespace_token_/g,':');}H=H.replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,'<$1 $2>');a.file(n,H);}});}function y(d,n,a){var b=d.createElement(n);if(a){if(a.attr){$(b).attr(a.attr);}if(a.children){$.each(a.children,function(e,i){b.appendChild(i);});}if(a.text!==null&&a.text!==u){b.appendChild(d.createTextNode(a.text));}}return b;}function z(d,e){var j=d.header[e].length;var n,s,C;if(d.footer&&d.footer[e].length>j){j=d.footer[e].length;}for(var i=0,E=d.body.length;i<E;i++){var F=d.body[i][e];C=F!==null&&F!==u?F.toString():'';if(C.indexOf('\n')!==-1){s=C.split('\n');s.sort(function(a,b){return b.length-a.length;});n=s[0].length;}else{n=C.length;}if(n>j){j=n;}if(j>40){return 52;}}j*=1.3;return j>6?j:6;}var A={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>'+'</Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>'+'<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>'+'</Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">'+'<Default Extension="xml" ContentType="application/xml" />'+'<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />'+'<Default Extension="jpeg" ContentType="image/jpeg" />'+'<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" />'+'<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />'+'<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" />'+'</Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>'+'<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>'+'<bookViews>'+'<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>'+'</bookViews>'+'<sheets>'+'<sheet name="" sheetId="1" r:id="rId1"/>'+'</sheets>'+'</workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<sheetData/>'+'<mergeCells count="0"/>'+'</worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?>'+'<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<numFmts count="6">'+'<numFmt numFmtId="164" formatCode="#,##0.00_-\ [$$-45C]"/>'+'<numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/>'+'<numFmt numFmtId="166" formatCode="[$€-2]\ #,##0.00"/>'+'<numFmt numFmtId="167" formatCode="0.0%"/>'+'<numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/>'+'<numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/>'+'</numFmts>'+'<fonts count="5" x14ac:knownFonts="1">'+'<font>'+'<sz val="11" />'+'<name val="Calibri" />'+'</font>'+'<font>'+'<sz val="11" />'+'<name val="Calibri" />'+'<color rgb="FFFFFFFF" />'+'</font>'+'<font>'+'<sz val="11" />'+'<name val="Calibri" />'+'<b />'+'</font>'+'<font>'+'<sz val="11" />'+'<name val="Calibri" />'+'<i />'+'</font>'+'<font>'+'<sz val="11" />'+'<name val="Calibri" />'+'<u />'+'</font>'+'</fonts>'+'<fills count="6">'+'<fill>'+'<patternFill patternType="none" />'+'</fill>'+'<fill/>'+'<fill>'+'<patternFill patternType="solid">'+'<fgColor rgb="FFD9D9D9" />'+'<bgColor indexed="64" />'+'</patternFill>'+'</fill>'+'<fill>'+'<patternFill patternType="solid">'+'<fgColor rgb="FFD99795" />'+'<bgColor indexed="64" />'+'</patternFill>'+'</fill>'+'<fill>'+'<patternFill patternType="solid">'+'<fgColor rgb="ffc6efce" />'+'<bgColor indexed="64" />'+'</patternFill>'+'</fill>'+'<fill>'+'<patternFill patternType="solid">'+'<fgColor rgb="ffc6cfef" />'+'<bgColor indexed="64" />'+'</patternFill>'+'</fill>'+'</fills>'+'<borders count="2">'+'<border>'+'<left />'+'<right />'+'<top />'+'<bottom />'+'<diagonal />'+'</border>'+'<border diagonalUp="false" diagonalDown="false">'+'<left style="thin">'+'<color auto="1" />'+'</left>'+'<right style="thin">'+'<color auto="1" />'+'</right>'+'<top style="thin">'+'<color auto="1" />'+'</top>'+'<bottom style="thin">'+'<color auto="1" />'+'</bottom>'+'<diagonal />'+'</border>'+'</borders>'+'<cellStyleXfs count="1">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" />'+'</cellStyleXfs>'+'<cellXfs count="67">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment horizontal="left"/>'+'</xf>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment horizontal="center"/>'+'</xf>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment horizontal="right"/>'+'</xf>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment horizontal="fill"/>'+'</xf>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment textRotation="90"/>'+'</xf>'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1">'+'<alignment wrapText="1"/>'+'</xf>'+'<xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'<xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/>'+'</cellXfs>'+'<cellStyles count="1">'+'<cellStyle name="Normal" xfId="0" builtinId="0" />'+'</cellStyles>'+'<dxfs count="0" />'+'<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" />'+'</styleSheet>'};var B=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(d){return d/100;}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(d){return d/100;}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(d){return-1*d.replace(/[\(\)]/g,'');}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(d){return-1*d.replace(/[\(\)]/g,'');}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64}];D.ext.buttons.copyHtml5={className:'buttons-copy buttons-html5',text:function(d){return d.i18n('buttons.copy','Copy');},action:function(e,d,b,a){this.processing(true);var i=this;var j=m(d,a);var n=d.buttons.exportInfo(a);var s=l(a);var C=j.str;var E=$('<div/>').css({height:1,width:1,overflow:'hidden',position:'fixed',top:0,left:0});if(n.title){C=n.title+s+s+C;}if(n.messageTop){C=n.messageTop+s+s+C;}if(n.messageBottom){C=C+s+s+n.messageBottom;}if(a.customize){C=a.customize(C,a);}var F=$('<textarea readonly/>').val(C).appendTo(E);if(c.queryCommandSupported('copy')){E.appendTo(d.table().container());F[0].focus();F[0].select();try{var G=c.execCommand('copy');E.remove();if(G){d.buttons.info(d.i18n('buttons.copyTitle','Copy to clipboard'),d.i18n('buttons.copySuccess',{1:'Copied one row to clipboard',_:'Copied %d rows to clipboard'},j.rows),2000);this.processing(false);return;}}catch(t){}}var H=$('<span>'+d.i18n('buttons.copyKeys','Press <i>ctrl</i> or <i>\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>'+'To cancel, click this message or press escape.')+'</span>').append(E);d.buttons.info(d.i18n('buttons.copyTitle','Copy to clipboard'),H,0);F[0].focus();F[0].select();var I=$(H).closest('.dt-button-info');var J=function(){I.off('click.buttons-copy');$(c).off('.buttons-copy');d.buttons.info(false);};I.on('click.buttons-copy',J);$(c).on('keydown.buttons-copy',function(e){if(e.keyCode===27){J();i.processing(false);}}).on('copy.buttons-copy cut.buttons-copy',function(){J();i.processing(false);});},exportOptions:{},fieldSeparator:'\t',fieldBoundary:'',header:true,footer:false,title:'*',messageTop:'*',messageBottom:'*'};D.ext.buttons.csvHtml5={bom:false,className:'buttons-csv buttons-html5',available:function(){return w.FileReader!==u&&w.Blob;},text:function(d){return d.i18n('buttons.csv','CSV');},action:function(e,d,b,a){this.processing(true);var i=m(d,a).str;var j=d.buttons.exportInfo(a);var n=a.charset;if(a.customize){i=a.customize(i,a);}if(n!==false){if(!n){n=c.characterSet||c.charset;}if(n){n=';charset='+n;}}else{n='';}if(a.bom){i='\ufeff'+i;}h(new Blob([i],{type:'text/csv'+n}),j.filename,true);this.processing(false);},filename:'*',extension:'.csv',exportOptions:{},fieldSeparator:',',fieldBoundary:'"',escapeChar:'"',charset:null,header:true,footer:false};D.ext.buttons.excelHtml5={className:'buttons-excel buttons-html5',available:function(){return w.FileReader!==u&&_()!==u&&!o()&&r;},text:function(d){return d.i18n('buttons.excel','Excel');},action:function(e,d,b,a){this.processing(true);var s=this;var C=0;var E=function(j){var T=A[j];return $.parseXML(T);};var F=E('xl/worksheets/sheet1.xml');var G=F.getElementsByTagName("sheetData")[0];var H={_rels:{".rels":E('_rels/.rels')},xl:{_rels:{"workbook.xml.rels":E('xl/_rels/workbook.xml.rels')},"workbook.xml":E('xl/workbook.xml'),"styles.xml":E('xl/styles.xml'),"worksheets":{"sheet1.xml":F}},"[Content_Types].xml":E('[Content_Types].xml')};var I=d.buttons.exportData(a.exportOptions);var J,K;var L=function(T){J=C+1;K=y(F,"row",{attr:{r:J}});for(var i=0,Q=T.length;i<Q;i++){var U=q(i)+''+J;var V=null;if(T[i]===null||T[i]===u||T[i]===''){continue;}T[i]=$.trim(T[i]);for(var j=0,W=B.length;j<W;j++){var X=B[j];if(T[i].match&&!T[i].match(/^0\d+/)&&T[i].match(X.match)){var Y=T[i].replace(/[^\d\.\-]/g,'');if(X.fmt){Y=X.fmt(Y);}V=y(F,'c',{attr:{r:U,s:X.style},children:[y(F,'v',{text:Y})]});break;}}if(!V){if(typeof T[i]==='number'||(T[i].match&&T[i].match(/^-?\d+(\.\d+)?$/)&&!T[i].match(/^0\d+/))){V=y(F,'c',{attr:{t:'n',r:U},children:[y(F,'v',{text:T[i]})]});}else{var Z=!T[i].replace?T[i]:T[i].replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,'');V=y(F,'c',{attr:{t:'inlineStr',r:U},children:{row:y(F,'is',{children:{row:y(F,'t',{text:Z})}})}});}}K.appendChild(V);}G.appendChild(K);C++;};$('sheets sheet',H.xl['workbook.xml']).attr('name',k(a));if(a.customizeData){a.customizeData(I);}var M=function(j,T){var M=$('mergeCells',F);M.append('<mergeCell ref="A'+j+':'+q(T)+j+'" />');M.attr('count',M.attr('count')+1);$('row:eq('+(j-1)+') c',F).attr('s','51');};var N=d.buttons.exportInfo(a);if(N.title){L([N.title],C);M(C,I.header.length-1);}if(N.messageTop){L([N.messageTop],C);M(C,I.header.length-1);}if(a.header){L(I.header,C);$('row:last c',F).attr('s','2');}for(var n=0,O=I.body.length;n<O;n++){L(I.body[n],C);}if(a.footer&&I.footer){L(I.footer,C);$('row:last c',F).attr('s','2');}if(N.messageBottom){L([N.messageBottom],C);M(C,I.header.length-1);}var P=y(F,'cols');$('worksheet',F).prepend(P);for(var i=0,Q=I.header.length;i<Q;i++){P.appendChild(y(F,'col',{attr:{min:i+1,max:i+1,width:z(I,i),customWidth:1}}));}if(a.customize){a.customize(H);}var f=_();var R=new f();var S={type:'blob',mimeType:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'};x(R,H);if(R.generateAsync){R.generateAsync(S).then(function(j){h(j,N.filename);s.processing(false);});}else{h(R.generate(S),N.filename);this.processing(false);}},filename:'*',extension:'.xlsx',exportOptions:{},header:true,footer:false,title:'*',messageTop:'*',messageBottom:'*'};D.ext.buttons.pdfHtml5={className:'buttons-pdf buttons-html5',available:function(){return w.FileReader!==u&&g();},text:function(d){return d.i18n('buttons.pdf','PDF');},action:function(e,a,b,j){this.processing(true);var n=this;var s=a.buttons.exportData(j.exportOptions);var C=a.buttons.exportInfo(j);var E=[];if(j.header){E.push($.map(s.header,function(d){return{text:typeof d==='string'?d:d+'',style:'tableHeader'};}));}for(var i=0,F=s.body.length;i<F;i++){E.push($.map(s.body[i],function(d){return{text:typeof d==='string'?d:d+'',style:i%2?'tableBodyEven':'tableBodyOdd'};}));}if(j.footer&&s.footer){E.push($.map(s.footer,function(d){return{text:typeof d==='string'?d:d+'',style:'tableFooter'};}));}var G={pageSize:j.pageSize,pageOrientation:j.orientation,content:[{table:{headerRows:1,body:E},layout:'noBorders'}],styles:{tableHeader:{bold:true,fontSize:11,color:'white',fillColor:'#2d4154',alignment:'center'},tableBodyEven:{},tableBodyOdd:{fillColor:'#f3f3f3'},tableFooter:{bold:true,fontSize:11,color:'white',fillColor:'#2d4154'},title:{alignment:'center',fontSize:15},message:{}},defaultStyle:{fontSize:10}};if(C.messageTop){G.content.unshift({text:C.messageTop,style:'message',margin:[0,0,0,12]});}if(C.messageBottom){G.content.push({text:C.messageBottom,style:'message',margin:[0,0,0,12]});}if(C.title){G.content.unshift({text:C.title,style:'title',margin:[0,0,0,12]});}if(j.customize){j.customize(G,j);}var H=g().createPdf(G);if(j.download==='open'&&!o()){H.open();this.processing(false);}else{H.getBuffer(function(d){var I=new Blob([d],{type:'application/pdf'});h(I,C.filename);n.processing(false);});}},title:'*',filename:'*',extension:'.pdf',exportOptions:{},orientation:'portrait',pageSize:'A4',header:true,footer:false,messageTop:'*',messageBottom:'*',customize:null,download:'download'};return D.Buttons;}));
