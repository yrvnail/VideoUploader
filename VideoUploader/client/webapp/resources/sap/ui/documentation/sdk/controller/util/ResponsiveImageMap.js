/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./overlay/Overlay","./Tooltip"],function(O,T){"use strict";var R=function(d){var m=d.querySelector('map'),i=d.querySelector('img');this.oImg=i;this.oMapWrapper=this.oImg.parentNode;this.oOverlay=new O(this.oImg.parentNode);this.oToolTip=new T();this.fnHandlers={areaMouseenter:this.onmouseenter.bind(this),areaMouseleave:this.onmouseleave.bind(this)};this.iOriginalWidth=i.naturalWidth;this.areas=Array.prototype.map.call(m.getElementsByTagName('area'),function(a){a.addEventListener("mouseenter",this.fnHandlers.areaMouseenter);a.addEventListener("mouseleave",this.fnHandlers.areaMouseleave);return{element:a,originalCoords:a.getAttribute('originalCoords').split(',')};},this);this.resize();};R.prototype.resize=function(){var n,r=this.oImg.offsetWidth/this.iOriginalWidth;this.areas.forEach(function(a){n=[];a.originalCoords.forEach(function(o){n.push(Math.round(o*r));});a.element.coords=n.join(',');});this.resizeOverlay();return true;};R.prototype.resizeOverlay=function(){var r=this.oMapWrapper.getBoundingClientRect(),w=r.width,h=r.height;this.oOverlay.setSize(w,h);};R.prototype.onmouseenter=function(e){if(this.bAreasDisabled){return;}var c=e.target.coords,s=e.target.getAttribute("shape");this.oOverlay.setShape(s,c);this.oOverlay.show();this.sTitle=this.getTooltipText(e);if(this.sTitle){e.target.setAttribute('title','');this.oToolTip.setText(this.sTitle);this.oToolTip.show(this.oOverlay.getCurrentShape().oContainer);}};R.prototype.getTooltipText=function(e){return e.target.getAttribute('title');};R.prototype.onmouseleave=function(e){if(this.sTitle){e.target.setAttribute('title',this.sTitle);}this.oOverlay.hide();this.oToolTip.hide();};R.prototype.removeEventListeners=function(){this.areas.forEach(function(a){a.element.removeEventListener("mouseenter",this.fnHandlers.areaMouseenter);a.element.removeEventListener("mouseleave",this.fnHandlers.areaMouseleave);},this);};return R;});
