/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Change","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger"],function(C,U,a,b){"use strict";function g(m,p){m[p]=m[p]||{byId:{},variants:[],nonPersistedVariants:[],changes:[],defaultVariants:[],standardVariantChange:undefined,standardVariant:undefined};return m[p];}function i(m,p,v){v=v||[];var M=g(m,p);M.nonPersistedVariants.forEach(function(V){delete M.byId[V.getId()];});M.nonPersistedVariants=v.map(function(V){var o=Object.assign({id:V.id,persisted:false},V);o=b.createVariant(p,o);M.byId[V.id]=o;return o;});return M;}function c(m,s,d){var o=s==="variants"?a:U;var f=m[s].map(function(e){var F=new o(e);F.setState(C.states.PERSISTED);return F;});f.forEach(function(F){var p=F.getSelector().persistencyKey;g(d,p).byId[F.getId()]=F;switch(s){case"standardVariants":g(d,p).standardVariantChange=F;break;default:g(d,p)[s].push(F);}});}return function(p){var m={};m._getOrCreate=g.bind(undefined,m);m._initialize=i.bind(undefined,m);if(p.storageResponse.changes.comp){["variants","changes","defaultVariants","standardVariants"].forEach(function(s){c(p.storageResponse.changes.comp,s,m);});}return m;};});
