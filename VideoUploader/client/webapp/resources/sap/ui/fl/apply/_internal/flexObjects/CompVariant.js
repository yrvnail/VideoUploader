/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(_,C,L,S,a,U){"use strict";function i(A){var u=U.getUshellContainer();var o=u&&u.getUser();return!o||o.getId().toUpperCase()===A.toUpperCase();}function c(l,A,u,f){if(A){return f||l===A;}else if(l===L.USER){return true;}var s=S.getInstanceOrUndef();if(a.isSapUiLayerParameterProvided()){A=a.getCurrentLayer();}else if(!A){A=s.isPublicLayerAvailable()?L.PUBLIC:L.CUSTOMER;}var g=l===A;var h=s.isKeyUser()||i(u);return g&&h;}function b(o){return!o||U.getCurrentLanguage()===o;}function d(s,f){var o=S.getInstanceOrUndef();if(!o){return true;}if(!s||!f){return true;}var g=o.getSystem();var h=o.getClient();return g===s&&f===h;}var e=C.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(f){C.apply(this,arguments);var E=f.content&&(f.content.executeOnSelect||f.content.executeOnSelection);if(f.executeOnSelection!==undefined){E=f.executeOnSelection;}this.setExecuteOnSelection(E);this.setContexts(f.contexts||{});this.setContent(f.content||{});this.setName(this.getText("variantName"));if(f.layer===L.VENDOR||f.layer===L.CUSTOMER_BASE){this.setFavorite(true);}if(f.favorite!==undefined){this.setFavorite(!!f.favorite);}if(f.persisted!==undefined){this.setPersisted(!!f.persisted);}}});e.STANDARD_VARIANT_ID="*standard*";e.prototype.isRenameEnabled=function(l){return this.isEditEnabled(l)&&b(this.getOriginalLanguage())&&!this.getStandardVariant();};e.prototype.isEditEnabled=function(A){return d(this.getSourceSystem(),this.getSourceClient())&&c(this.getLayer(),A,this.getOwnerId(),true)&&(A&&a.isDeveloperLayer(A)||!this.getStandardVariant());};e.prototype.isDeleteEnabled=function(l){return d(this.getSourceSystem(),this.getSourceClient())&&c(this.getLayer(),l,this.getOwnerId())&&!this.getStandardVariant();};e.prototype.storeFavorite=function(f){if(f!==undefined){this._oDefinition.favorite=f;}else{delete this._oDefinition.favorite;}this.setState(C.states.DIRTY);this.setFavorite(f);};e.prototype.setContent=function(o){this.setProperty("content",o||{});};e.prototype.getContent=function(){return this.getProperty("content");};e.prototype.storeContent=function(o){this._oDefinition.content=o||{};this.setState(C.states.DIRTY);this.setContent(o);};e.prototype.storeExecuteOnSelection=function(E){if(E!==undefined){this._oDefinition.executeOnSelection=E;}else{delete this._oDefinition.executeOnSelection;}delete this._oDefinition.content.executeOnSelection;this.setState(C.states.DIRTY);this.setExecuteOnSelection(E);};e.prototype.storeName=function(n){this._oDefinition.texts.variantName.value=n;this.setState(C.states.DIRTY);this.setName(n);};e.prototype.storeContexts=function(m){if(m!==undefined){this._oDefinition.contexts=m;}else{delete this._oDefinition.contexts;}this.setContexts(m);this.setState(C.states.DIRTY);};e.createInitialFileContent=function(p){var n=C.createInitialFileContent(p);if(p.contexts){n.contexts=p.contexts;}if(p.favorite!==undefined){n.favorite=p.favorite;}if(p.executeOnSelection!==undefined){n.executeOnSelection=p.executeOnSelection;}return _(n,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"]);};return e;});
