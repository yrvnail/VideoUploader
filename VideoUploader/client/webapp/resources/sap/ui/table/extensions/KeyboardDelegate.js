/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../utils/TableUtils","../library","sap/ui/base/Object","sap/ui/Device","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery"],function(T,l,B,D,K,q){"use strict";var C=T.CELLTYPE;var S=l.SelectionMode;var M={CTRL:1,SHIFT:2,ALT:4};var H=5;var a="1rem";function p(E,P){E.setMarked("sapUiTableSkipItemNavigation",P!==false);}var b=B.extend("sap.ui.table.extensions.KeyboardDelegate",{constructor:function(i){B.call(this);},destroy:function(){B.prototype.destroy.apply(this,arguments);},getInterface:function(){return this;}});function n(i,E){if(!e(i,E)){return;}var F=T.getCellInfo(T.getCell(i,E.target));if(F.isOfType(C.ANYCOLUMNHEADER)){_(i,F,E);}else if(F.isOfType(C.ANYCONTENTCELL)){c(i,F,E);}}function _(i,E,F){var G=T.getHeaderRowCount(i);if(T.isNoDataVisible(i)){var I=T.getFocusedItemInfo(i);if(I.row-G<=1){p(F);}}else if(E.isOfType(C.COLUMNROWHEADER)&&G>1){p(F);T.focusItem(i,G*(T.getVisibleColumnCount(i)+1),F);}}function c(i,E,F){var G=i._getKeyboardExtension();var I=G.isInActionMode();var J=b._isKeyCombination(F,null,M.CTRL);var L=J||I;var P=T.getParentCell(i,F.target);if(!L&&P){P.trigger("focus");return;}p(F);if(T.isLastScrollableRow(i,E.cell)){var N=s(i,F);if(N){F.preventDefault();return;}}if(E.rowIndex===i.getRows().length-1){if(!I&&P){P.trigger("focus");}else{var O=i.getCreationRow();if(!O||!O._takeOverKeyboardHandling(F)){G.setActionMode(false);}}return;}z(i,E.type,E.rowIndex+1,E.columnIndex,L);F.preventDefault();}function d(i,E){var F=T.getCellInfo(T.getCell(i,E.target));if(!F.isOfType(C.ANYCONTENTCELL)||!e(i,E)){return;}var G=b._isKeyCombination(E,null,M.CTRL);var I=i._getKeyboardExtension();var J=I.isInActionMode();var L=G||J;var P=T.getParentCell(i,E.target);if(!L&&P){P.trigger("focus");return;}p(E);if(T.isFirstScrollableRow(i,F.cell)){var N=g(i,E);if(N){E.preventDefault();return;}}if(F.rowIndex===0){p(E,F.isOfType(C.ROWACTION)||L);if(!J&&P){P.trigger("focus");}else{I.setActionMode(false);}return;}z(i,F.type,F.rowIndex-1,F.columnIndex,L);E.preventDefault();}function e(i,E){var F=b._isKeyCombination(E,null,M.CTRL);return!E.isMarked()&&(F||!(E.target instanceof window.HTMLInputElement)&&!(E.target instanceof window.HTMLTextAreaElement));}function f(i,E){if(E.isMarked()){return;}var F=T.getCellInfo(T.getCell(i,E.target));var I=sap.ui.getCore().getConfiguration().getRTL();if(!F.isOfType(C.COLUMNHEADER)||!I){return;}var G=T.getFocusedItemInfo(i);var J=G.cellInRow-(T.hasRowHeader(i)?1:0);var L=T.getVisibleColumnCount(i);if(T.hasRowActions(i)&&J===L-1){p(E);}}function s(i,E,P,F){var G=i._getFirstRenderedRowIndex()===i._getMaxFirstRenderedRowIndex();if(G){return null;}h(i,E,true,P,F);return true;}function g(i,E,P,F){var G=i._getFirstRenderedRowIndex()===0;if(G){return false;}h(i,E,false,P,F);return true;}function h(i,E,F,P,G){var I=T.getCellInfo(T.getCell(i,E.target));var J=i._getKeyboardExtension().isInActionMode();var L=b._isKeyCombination(E,null,M.CTRL);var N=L||J;var O=J&&I.isOfType(C.DATACELL);if(O){i._getKeyboardExtension()._setSilentFocus(i.getDomRef("focusDummy"));setTimeout(function(){i._getScrollExtension().scrollVertically(F===true,P);},0);}else{i._getScrollExtension().scrollVertically(F===true,P);}if(N||G){i.attachEventOnce("rowsUpdated",function(){if(G){G();}else{z(i,I.type,I.rowIndex,I.columnIndex,true);}});}}function j(i,E){var R=i._getRowCounts();var F=s(i,E,false,function(){k(i,R.fixedTop+R.scrollable-1);});if(F){return;}if(R.fixedBottom>0){k(i,R.fixedTop+R.scrollable);}else{i._getKeyboardExtension().setActionMode(false);}}function k(i,R){var E=i.getRows()[R];var F=E.isGroupHeader()||T.isRowSelectorSelectionAllowed(i);if(F){z(i,C.ROWHEADER,R);}else{var I=b._getFirstInteractiveElement(E);if(I){b._focusElement(i,I[0]);}else{z(i,C.DATACELL,R,0,false,true);if(E.getIndex()===i._getTotalRowCount()-1){i._getKeyboardExtension().setActionMode(false);}}}}function m(i,E){var R=i._getRowCounts();var F=g(i,E,false,function(){o(i,R.fixedTop);});if(F){return;}if(R.fixedTop>0){o(i,R.fixedTop-1);}else{i._getKeyboardExtension().setActionMode(false);}}function o(i,R){var E=i.getRows()[R];var F=E.isGroupHeader()||T.isRowSelectorSelectionAllowed(i);var I=b._getLastInteractiveElement(E);if(I){b._focusElement(i,I[0]);}else if(F){z(i,C.ROWHEADER,R);}else{z(i,C.DATACELL,R,0,false,true);if(E.getIndex()===0){i._getKeyboardExtension().setActionMode(false);}}}function r(i,E){var F=T.getFocusedItemInfo(i);var L=i._getKeyboardExtension()._getLastFocusedCellInfo();T.focusItem(i,F.cellInRow+(F.columnCount*L.row),E);}function t(i,E){var F=T.getFocusedItemInfo(i);T.focusItem(i,F.cellInRow,E);}function u(i,E){i._getKeyboardExtension()._setSilentFocus(i.$().find("."+E));}b._isKeyCombination=function(E,i,F){if(F==null){F=0;}var G=typeof i==="string"?String.fromCharCode(E.charCode):E.keyCode;var I=0;I|=(D.os.macintosh?E.metaKey:E.ctrlKey)&&i!==K.CONTROL?M.CTRL:0;I|=E.shiftKey&&i!==K.SHIFT?M.SHIFT:0;I|=E.altKey&&i!==K.ALT?M.ALT:0;var V=i==null||G===i;var J=F===I;return V&&J;};function v(i,E){var $=T.getCell(i,E);var F=T.getCellInfo($);return i.getRows()[F.rowIndex];}function w(i,E){var F=T.getCellInfo(E.target);if(F.isOfType(C.COLUMNROWHEADER)){i._getSelectionPlugin().onHeaderSelectorPress();}else if(b._isElementGroupToggler(i,E.target)){v(i,E.target).toggleExpandedState();}else if(F.isOfType(C.ROWHEADER)){J();}else if(F.isOfType(C.DATACELL|C.ROWACTION)){var G=!i.hasListeners("cellClick");if(!i._findAndfireCellEvent(i.fireCellClick,E)){if(T.isRowSelectionAllowed(i)){J();G=false;}}if(G){var I=T.getInteractiveElements(E.target);if(I){i._getKeyboardExtension().setActionMode(true);}}}function J(){var L=null;if(i._legacyMultiSelection){L=function(R){i._legacyMultiSelection(R,E);return true;};}T.toggleRowSelection(i,E.target,null,L);}}function x(i,N){var E=i.getParent();var V=E._getVisibleColumns();var I=V.indexOf(i);var F;if(N&&I<V.length-1){F=E.indexOfColumn(V[I+1])+1;}else if(!N&&I>0){F=E.indexOfColumn(V[I-1]);}if(F!=null){T.Column.moveColumnTo(i,F);}}function y(E,F){var V=E.getColumns().filter(function(F){return F.getVisible()||F.getGrouped();});for(var i=0;i<V.length;i++){var G=V[i];if(G===F){return i;}}return-1;}b._focusElement=function(i,E,F){if(!i||!E){return;}if(F==null){F=false;}T.deselectElementText(document.activeElement);if(F){i._getKeyboardExtension()._setSilentFocus(E);}else{E.focus();}T.selectElementText(E);};function z(i,E,R,F,G,I){if(!i||E==null||R==null||R<0||R>=i.getRows().length){return;}var J=i.getRows()[R];var L;if(E===C.ROWHEADER){i._getKeyboardExtension()._setFocus(i.getDomRef("rowsel"+R));return;}else if(E===C.ROWACTION){L=i.getDomRef("rowact"+R);}else if(E===C.DATACELL&&(F!=null&&F>=0)){var N=i.getColumns()[F];var O=y(i,N);if(O>=0){L=J.getDomRef("col"+O);}}if(!L){return;}if(G){var $=T.getInteractiveElements(L);if($){b._focusElement(i,$[0]);return;}}if(I){i._getKeyboardExtension()._bStayInActionMode=true;}L.focus();}b._isElementGroupToggler=function(i,E){return T.Grouping.isInGroupHeaderRow(E)||(T.Grouping.isTreeMode(i)&&E.classList.contains("sapUiTableCellFirst")&&(E.querySelector(".sapUiTableTreeIconNodeOpen")||E.querySelector(".sapUiTableTreeIconNodeClosed")))||E.classList.contains("sapUiTableTreeIconNodeOpen")||E.classList.contains("sapUiTableTreeIconNodeClosed");};b._isElementInteractive=function(E){if(!E){return false;}return q(E).is(T.INTERACTIVE_ELEMENT_SELECTORS);};b._getFirstInteractiveElement=function(R){var E=T.getFirstInteractiveElement(R,true);if(!E){return null;}return q(E);};b._getLastInteractiveElement=function(R){if(!R){return null;}var E=R.getParent();var F=R.getCells();var $;var I;if(T.hasRowActions(E)){F.push(R.getRowAction());}for(var i=F.length-1;i>=0;i--){$=T.getParentCell(E,F[i].getDomRef());I=T.getInteractiveElements($);if(I){return I.last();}}return null;};b._getPreviousInteractiveElement=function(E,F){if(!E||!F){return null;}var $=q(F);if(!this._isElementInteractive($)){return null;}var G=T.getParentCell(E,F);var I;var J;var L;var N;var O;var P;var Q;I=T.getInteractiveElements(G);if(I[0]!==$[0]){return I.eq(I.index(F)-1);}J=T.getCellInfo(G);N=E.getRows()[J.rowIndex].getCells();if(J.isOfType(C.ROWACTION)){Q=N.length-1;}else{O=E.getColumns()[J.columnIndex];P=y(E,O);Q=P-1;}for(var i=Q;i>=0;i--){L=N[i].getDomRef();G=T.getParentCell(E,L);I=T.getInteractiveElements(G);if(I){return I.last();}}return null;};b._getNextInteractiveElement=function(E,F){if(!E||!F){return null;}var $=q(F);if(!this._isElementInteractive($)){return null;}var G=T.getParentCell(E,F);var I;var J;var L;var N;var O;var R;var P;I=T.getInteractiveElements(G);if(I.get(-1)!==$[0]){return I.eq(I.index(F)+1);}J=T.getCellInfo(G);if(J.isOfType(C.ROWACTION)){return null;}R=E.getRows()[J.rowIndex];N=R.getCells();O=E.getColumns()[J.columnIndex];P=y(E,O);for(var i=P+1;i<N.length;i++){L=N[i].getDomRef();G=T.getParentCell(E,L);I=T.getInteractiveElements(G);if(I){return I.first();}}if(T.hasRowActions(E)){G=T.getParentCell(E,R.getRowAction().getDomRef());I=T.getInteractiveElements(G);if(I.get(-1)!==$[0]){return I.eq(I.index(F)+1);}}return null;};function A(i){var F=T.getRowIndexOfFocusedCell(i);var E=i.getRows()[F].getIndex();var G=i._getSelectionPlugin();i._oRangeSelection={startIndex:E,selected:G.isIndexSelected(E)};}b.prototype.enterActionMode=function(){var i=this._getKeyboardExtension();var E=document.activeElement;var I=T.getInteractiveElements(E);var $=T.getParentCell(this,E);var F=T.getCellInfo($);if(F.isOfType(C.ANYCOLUMNHEADER)){return false;}if(I){i._suspendItemNavigation();E.tabIndex=-1;b._focusElement(this,I[0],true);return true;}else if($){this._getKeyboardExtension()._suspendItemNavigation();return true;}return false;};b.prototype.leaveActionMode=function(i){i=i==null?true:i;var E=this._getKeyboardExtension();var F=document.activeElement;var $=T.getParentCell(this,F);E._resumeItemNavigation();if(i){if($){b._focusElement(this,$[0],true);}else{var I=this._getItemNavigation();if(I){var G=I.aItemDomRefs;var J=G.indexOf(F);if(J>-1){I.setFocusedIndex(J);}}E._setSilentFocus(F);}}};b.prototype.onfocusin=function(E){if(E.isMarked("sapUiTableIgnoreFocusIn")){return;}var $=q(E.target);if($.hasClass("sapUiTableOuterBefore")||$.hasClass("sapUiTableOuterAfter")||(E.target!=this.getDomRef("overlay")&&this.getShowOverlay())){this.$("overlay").trigger("focus");}else if($.hasClass("sapUiTableCtrlBefore")){var N=T.isNoDataVisible(this);if(!N||N&&this.getColumnHeaderVisible()){t(this,E);}else{this._getKeyboardExtension()._setSilentFocus(this.$("noDataCnt"));}}else if($.hasClass("sapUiTableCtrlAfter")){if(!T.isNoDataVisible(this)){r(this,E);}}var i=T.getCellInfo(E.target);var I=i.isOfType(C.ROWHEADER)&&T.Grouping.isInGroupHeaderRow(E.target);var F=i.isOfType(C.ROWHEADER)&&!I&&T.isRowSelectorSelectionAllowed(this);var G=i.isOfType(C.DATACELL)&&this._getKeyboardExtension()._bStayInActionMode;var P=T.getCellInfo(T.getParentCell(this,E.target)).isOfType(C.ANYCONTENTCELL);var J=b._isElementInteractive(E.target);var L=this._getKeyboardExtension().isInActionMode();var O=(L&&(I||F||G)||(J&&P));if(G){this._getKeyboardExtension()._bStayInActionMode=false;}this._getKeyboardExtension().setActionMode(O,false);};b.prototype.onkeydown=function(E){var i=this._getKeyboardExtension();var F=T.getCellInfo(E.target);var G=this.getSelectionMode();var I=this._getSelectionPlugin();if(b._isKeyCombination(E,K.F2)){var J=i.isInActionMode();var $=T.getCell(this,E.target);var L=T.getParentCell(this,E.target)!=null;F=T.getCellInfo($);if(!J&&L){$.trigger("focus");}else if(F.isOfType(C.ANYCOLUMNHEADER)){var N=T.getInteractiveElements($);if(N){N[0].focus();}}else{i.setActionMode(!J);}return;}else if(b._isKeyCombination(E,K.F4)&&b._isElementGroupToggler(this,E.target)){v(this,E.target).toggleExpandedState();return;}if(this._getKeyboardExtension().isInActionMode()||!F.isOfType(C.ANY)){return;}if(b._isKeyCombination(E,K.SPACE)){E.preventDefault();}if(b._isKeyCombination(E,K.SHIFT)&&G===S.MultiToggle&&(F.isOfType(C.ROWHEADER)&&T.isRowSelectorSelectionAllowed(this)||(F.isOfType(C.DATACELL|C.ROWACTION)))){A(this);}else if(b._isKeyCombination(E,K.A,M.CTRL)){E.preventDefault();if(F.isOfType(C.ANYCONTENTCELL|C.COLUMNROWHEADER)&&G===S.MultiToggle){I.onKeyboardShortcut("toggle");}}else if(b._isKeyCombination(E,K.A,M.CTRL+M.SHIFT)){if(F.isOfType(C.ANYCONTENTCELL|C.COLUMNROWHEADER)){I.onKeyboardShortcut("clear");}}else if(b._isKeyCombination(E,K.F4)){if(F.isOfType(C.DATACELL)){i.setActionMode(true);}}};b.prototype.onkeypress=function(E){var i=this._getKeyboardExtension();var F=T.getCellInfo(E.target);if(b._isKeyCombination(E,"+")){if(b._isElementGroupToggler(this,E.target)){v(this,E.target).expand();}else if(F.isOfType(C.DATACELL|C.ROWACTION)){i.setActionMode(true);}}else if(b._isKeyCombination(E,"-")){if(b._isElementGroupToggler(this,E.target)){v(this,E.target).collapse();}else if(F.isOfType(C.DATACELL|C.ROWACTION)){i.setActionMode(true);}}};b.prototype.oncontextmenu=function(E){if(E.isMarked("handledByPointerExtension")){return;}var i=T.getCellInfo(document.activeElement);if(i.isOfType(C.ANY)){E.preventDefault();T.Menu.openContextMenu(this,E.target,E);}};b.prototype.onkeyup=function(E){var i=T.getCellInfo(E.target);if(b._isKeyCombination(E,K.SHIFT)){delete this._oRangeSelection;}if(i.isOfType(C.COLUMNHEADER)){if(b._isKeyCombination(E,K.SPACE)||b._isKeyCombination(E,K.ENTER)){T.Menu.openContextMenu(this,E.target);}}else if(b._isKeyCombination(E,K.SPACE)){w(this,E);}else if(b._isKeyCombination(E,K.SPACE,M.SHIFT)){T.toggleRowSelection(this,this.getRows()[i.rowIndex].getIndex());A(this);}else if(this._legacyMultiSelection&&!i.isOfType(C.COLUMNROWHEADER)&&(b._isKeyCombination(E,K.SPACE,M.CTRL)||b._isKeyCombination(E,K.ENTER,M.CTRL))){w(this,E);}};b.prototype.onsaptabnext=function(E){var F=this._getKeyboardExtension();var G=T.getCellInfo(E.target);var $;if(F.isInActionMode()){var I;$=T.getCell(this,E.target);G=T.getCellInfo($);if(!G.isOfType(C.ANYCONTENTCELL)){return;}var R=this.getRows()[G.rowIndex];var L=b._getLastInteractiveElement(R);var J=L===null||L[0]===E.target;if(J){var N=R.getIndex();var O=T.isLastScrollableRow(this,$);var P=this._getTotalRowCount()-1===N;var Q=T.isRowSelectorSelectionAllowed(this);E.preventDefault();if(P){F.setActionMode(false);}else if(O){j(this,E);}else{var U=G.rowIndex;if(Q){z(this,C.ROWHEADER,U+1);}else{var V=this.getRows().length;var W=false;for(var i=G.rowIndex+1;i<V;i++){U=i;R=this.getRows()[U];I=b._getFirstInteractiveElement(R);W=R.isGroupHeader();if(I||W){break;}}if(I){b._focusElement(this,I[0]);}else if(W){z(this,C.ROWHEADER,U);}else{j(this,E);}}}}else if(G.isOfType(C.ROWHEADER)){E.preventDefault();I=b._getFirstInteractiveElement(R);b._focusElement(this,I[0]);}else{E.preventDefault();I=b._getNextInteractiveElement(this,E.target);b._focusElement(this,I[0]);}}else if(G.isOfType(C.ANYCOLUMNHEADER)){if(T.isNoDataVisible(this)){this.$("noDataCnt").trigger("focus");E.preventDefault();}else if(this.getRows().length>0){r(this,E);E.preventDefault();}}else if(G.isOfType(C.ANYCONTENTCELL)){u(this,"sapUiTableCtrlAfter");}else if(E.target===this.getDomRef("overlay")){F._setSilentFocus(this.$().find(".sapUiTableOuterAfter"));}else if(!G.isOfType(C.ANY)){$=T.getParentCell(this,E.target);if($){E.preventDefault();$.trigger("focus");}}};b.prototype.onsaptabprevious=function(E){var F=this._getKeyboardExtension();var G=T.getCellInfo(E.target);var $;if(F.isInActionMode()){var I;$=T.getCell(this,E.target);G=T.getCellInfo($);if(!G.isOfType(C.ANYCONTENTCELL)){return;}var R=this.getRows()[G.rowIndex];var J=R.getIndex();var L=b._getFirstInteractiveElement(R);var N=L!==null&&L[0]===E.target;var O=T.isRowSelectorSelectionAllowed(this);var P=O||R.isGroupHeader();if(N&&P){E.preventDefault();z(this,C.ROWHEADER,G.rowIndex);}else if((N&&!P)||G.isOfType(C.ROWHEADER)||L===null){var Q=T.isFirstScrollableRow(this,$);var U=J===0;E.preventDefault();if(U){F.setActionMode(false);}else if(Q){m(this,E);}else{var V=G.rowIndex;var W=false;for(var i=G.rowIndex-1;i>=0;i--){V=i;R=this.getRows()[V];I=b._getLastInteractiveElement(R);W=R.isGroupHeader();if(I||P||W){break;}}if(I){b._focusElement(this,I[0]);}else if(W||P){z(this,C.ROWHEADER,V);}else{m(this,E);}}}else{E.preventDefault();I=b._getPreviousInteractiveElement(this,E.target);b._focusElement(this,I[0]);}}else if(G.isOfType(C.ANYCONTENTCELL)||E.target===this.getDomRef("noDataCnt")){if(this.getColumnHeaderVisible()&&!G.isOfType(C.ROWACTION)){t(this,E);E.preventDefault();}else{u(this,"sapUiTableCtrlBefore");}}else if(E.target===this.getDomRef("overlay")){this._getKeyboardExtension()._setSilentFocus(this.$().find(".sapUiTableOuterBefore"));}else if(!G.isOfType(C.ANY)){$=T.getParentCell(this,E.target);if($){E.preventDefault();$.trigger("focus");}}};b.prototype.onsapdown=function(E){n(this,E);};b.prototype.onsapdownmodifiers=function(E){if(b._isKeyCombination(E,null,M.CTRL)){n(this,E);return;}var i=this._getKeyboardExtension();if(b._isKeyCombination(E,null,M.ALT)&&b._isElementGroupToggler(this,E.target)){p(E);v(this,E.target).expand();return;}if(i.isInActionMode()){return;}var F=T.getCellInfo(E.target);if(b._isKeyCombination(E,null,M.SHIFT)){E.preventDefault();if(F.isOfType(C.ANYCONTENTCELL)){if(!this._oRangeSelection){p(E);return;}var G=T.getRowIndexOfFocusedCell(this);var I=this.getRows()[G].getIndex();if(I===this._getTotalRowCount()-1){return;}if(T.isLastScrollableRow(this,E.target)){var J=s(this,E);if(J){p(E);}}if(this._oRangeSelection.startIndex<=I){I++;if(this._oRangeSelection.selected){T.toggleRowSelection(this,I,true);}else{T.toggleRowSelection(this,I,false);}}else{T.toggleRowSelection(this,I,false);}}else{p(E);}}if(b._isKeyCombination(E,null,M.ALT)){if(F.isOfType(C.DATACELL)){i.setActionMode(true);}p(E);}};b.prototype.onsapup=function(E){d(this,E);};b.prototype.onsapupmodifiers=function(E){if(b._isKeyCombination(E,null,M.CTRL)){d(this,E);return;}if(b._isKeyCombination(E,null,M.ALT)&&b._isElementGroupToggler(this,E.target)){p(E);v(this,E.target).collapse();return;}var i=this._getKeyboardExtension();if(i.isInActionMode()){return;}var F=T.getCellInfo(E.target);if(b._isKeyCombination(E,null,M.SHIFT)){E.preventDefault();if(F.isOfType(C.ANYCONTENTCELL)){if(!this._oRangeSelection){p(E);return;}var G=T.getRowIndexOfFocusedCell(this);var I=this.getRows()[G].getIndex();if(I===0){p(E);return;}if(T.isFirstScrollableRow(this,E.target)){var J=g(this,E);if(J){p(E);}}if(this._oRangeSelection.startIndex>=I){I--;if(this._oRangeSelection.selected){T.toggleRowSelection(this,I,true);}else{T.toggleRowSelection(this,I,false);}}else{T.toggleRowSelection(this,I,false);}}else{p(E);}}if(b._isKeyCombination(E,null,M.ALT)){if(F.isOfType(C.DATACELL)){i.setActionMode(true);}p(E);}};b.prototype.onsapleft=function(E){f(this,E);};b.prototype.onsapleftmodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}var F=T.getCellInfo(E.target);var I=sap.ui.getCore().getConfiguration().getRTL();if(b._isKeyCombination(E,null,M.SHIFT)){E.preventDefault();if(F.isOfType(C.DATACELL)){if(!this._oRangeSelection){p(E);return;}var G=T.getFocusedItemInfo(this);var J=T.hasRowHeader(this)&&G.cellInRow===1;if(J&&!T.isRowSelectorSelectionAllowed(this)){p(E);}}else if(F.isOfType(C.ROWACTION)){if(!this._oRangeSelection){p(E);}}else if(F.isOfType(C.ROWHEADER)&&I){if(!T.isRowSelectionAllowed(this)){p(E);}}else if(F.isOfType(C.COLUMNROWHEADER)&&I){p(E);}else if(F.isOfType(C.COLUMNHEADER)){var R=-T.convertCSSSizeToPixel(a);var L=0;if(I){R=R*-1;}for(var i=F.columnIndex;i<F.columnIndex+F.columnSpan;i++){L+=T.Column.getColumnWidth(this,i);}T.Column.resizeColumn(this,F.columnIndex,L+R,true,F.columnSpan);p(E);}}else if(b._isKeyCombination(E,null,M.CTRL)){if(F.isOfType(C.COLUMNHEADER)){E.preventDefault();E.stopImmediatePropagation();var N=this.getColumns()[F.columnIndex];x(N,I);}}};b.prototype.onsaprightmodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}var F=T.getCellInfo(E.target);var I=sap.ui.getCore().getConfiguration().getRTL();if(b._isKeyCombination(E,null,M.SHIFT)){E.preventDefault();if(F.isOfType(C.DATACELL)){if(!this._oRangeSelection){p(E);}}else if(F.isOfType(C.ROWHEADER)){if(!T.isRowSelectionAllowed(this)){p(E);}}else if(F.isOfType(C.ROWACTION)&&I){if(!this._oRangeSelection){p(E);}}else if(F.isOfType(C.COLUMNHEADER)){var R=T.convertCSSSizeToPixel(a);var G=0;if(I){R=R*-1;}for(var i=F.columnIndex;i<F.columnIndex+F.columnSpan;i++){G+=T.Column.getColumnWidth(this,i);}T.Column.resizeColumn(this,F.columnIndex,G+R,true,F.columnSpan);p(E);}else if(F.isOfType(C.COLUMNROWHEADER)){p(E);}}else if(b._isKeyCombination(E,null,M.CTRL)){if(F.isOfType(C.COLUMNHEADER)){E.preventDefault();E.stopImmediatePropagation();var J=this.getColumns()[F.columnIndex];x(J,!I);}}};b.prototype.onsaphome=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(T.Grouping.isInGroupHeaderRow(E.target)){p(E);E.preventDefault();return;}var i=T.getCellInfo(E.target);if(i.isOfType(C.ANY)){E.preventDefault();}if(i.isOfType(C.DATACELL|C.ROWACTION|C.COLUMNHEADER)){var F=T.getFocusedItemInfo(this);var G=F.cell;var I=F.cellInRow;var J=this.getComputedFixedColumnCount();var L=T.hasRowHeader(this);var R=L?1:0;if(T.hasFixedColumns(this)&&I>J+R){p(E);T.focusItem(this,G-I+J+R,null);}else if(L&&I>1){p(E);T.focusItem(this,G-I+R,null);}}};b.prototype.onsapend=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(T.Grouping.isInGroupHeaderRow(E.target)){E.preventDefault();p(E);return;}var i=T.getCellInfo(E.target);if(i.isOfType(C.ANY)){E.preventDefault();var F=T.getFocusedItemInfo(this);var G=F.cell;var I=F.columnCount;var J=this.getComputedFixedColumnCount();var L=F.cellInRow;var N=T.hasRowHeader(this);var R=N?1:0;var O=false;if(i.isOfType(C.COLUMNHEADER)&&T.hasFixedColumns(this)){var P=parseInt(i.cell.attr("colspan")||1);if(P>1&&L+P-R===J){O=true;}}if(N&&L===0){p(E);T.focusItem(this,G+1,null);}else if(T.hasFixedColumns(this)&&L<J-1+R&&!O){p(E);T.focusItem(this,G+J-L,null);}else if(T.hasRowActions(this)&&i.isOfType(C.DATACELL)&&L<I-2){p(E);T.focusItem(this,G-L+I-2,null);}}};b.prototype.onsaphomemodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(E,null,M.CTRL)){E.preventDefault();var i=T.getCellInfo(E.target);if(i.isOfType(C.ANYCONTENTCELL|C.COLUMNHEADER)){p(E);var F=T.getFocusedItemInfo(this);var G=F.row;if(G>0){var I=F.cell;var J=F.columnCount;var L=T.getHeaderRowCount(this);var R=this._getRowCounts();if(G<L+R.fixedTop){if(i.isOfType(C.ROWACTION)){T.focusItem(this,I-J*(G-L),E);}else{T.focusItem(this,I-J*G,E);}}else if(G>=L+R.fixedTop&&G<L+T.getNonEmptyRowCount(this)-R.fixedBottom){this._getScrollExtension().scrollVerticallyMax(false);if(R.fixedTop>0||i.isOfType(C.ROWACTION)){T.focusItem(this,I-J*(G-L),E);}else{T.focusItem(this,I-J*G,E);}}else{this._getScrollExtension().scrollVerticallyMax(false);T.focusItem(this,I-J*(G-L-R.fixedTop),E);}}}}};b.prototype.onsapendmodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(E,null,M.CTRL)){E.preventDefault();var i=T.getCellInfo(E.target);if(i.isOfType(C.ANY)){var F=T.getFocusedItemInfo(this);var G=F.row;var I=T.getHeaderRowCount(this);var N=T.getNonEmptyRowCount(this);var R=this._getRowCounts();p(E);if(R.fixedBottom===0||G<I+N-1||(T.isNoDataVisible(this)&&G<I-1)){var J=F.cell;var L=F.columnCount;if(T.isNoDataVisible(this)){T.focusItem(this,J+L*(I-G-1),E);}else if(G<I){if(R.fixedTop>0){T.focusItem(this,J+L*(I+R.fixedTop-G-1),E);}else{this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,J+L*(I+N-R.fixedBottom-G-1),E);}}else if(G>=I&&G<I+R.fixedTop){this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,J+L*(I+N-R.fixedBottom-G-1),E);}else if(G>=I+R.fixedTop&&G<I+N-R.fixedBottom){this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,J+L*(I+N-G-1),E);}else{T.focusItem(this,J+L*(I+N-G-1),E);}}}}};b.prototype.onsappageup=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}E.preventDefault();var i=T.getCellInfo(E.target);if(i.isOfType(C.ANYCONTENTCELL|C.COLUMNHEADER)){var F=T.getFocusedItemInfo(this);var G=F.row;var I=T.getHeaderRowCount(this);var R=this._getRowCounts();if(R.fixedTop===0&&G>=I||R.fixedTop>0&&G>I){p(E);var J=F.cell;var L=F.columnCount;if(G<I+R.fixedTop){T.focusItem(this,J-L*(G-I),E);}else if(G===I+R.fixedTop){var P=T.getNonEmptyRowCount(this)-R.fixedTop-R.fixedBottom;var N=this.getFirstVisibleRow();g(this,E,true);if(N<P){if(R.fixedTop>0||i.isOfType(C.ROWACTION)){T.focusItem(this,J-L*(G-I),E);}else{T.focusItem(this,J-L*I,E);}}}else if(G>I+R.fixedTop&&G<I+T.getNonEmptyRowCount(this)){T.focusItem(this,J-L*(G-I-R.fixedTop),E);}else{T.focusItem(this,J-L*(G-I-T.getNonEmptyRowCount(this)+1),E);}}if(i.isOfType(C.ROWACTION)&&G===I&&R.fixedTop>0){p(E);}}};b.prototype.onsappagedown=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}E.preventDefault();var i=T.getCellInfo(E.target);if(i.isOfType(C.ANY)){var F=T.getFocusedItemInfo(this);var G=F.row;var I=T.getHeaderRowCount(this);var N=T.getNonEmptyRowCount(this);var R=this._getRowCounts();p(E);if((T.isNoDataVisible(this)&&G<I-1)||R.fixedBottom===0||G<I+N-1){var J=F.cell;var L=F.columnCount;if(G<I-1&&!i.isOfType(C.COLUMNROWHEADER)){T.focusItem(this,J+L*(I-G-1),E);}else if(G<I){if(!T.isNoDataVisible(this)){T.focusItem(this,J+L*(I-G),E);}}else if(G>=I&&G<I+N-R.fixedBottom-1){T.focusItem(this,J+L*(I+N-R.fixedBottom-G-1),E);}else if(G===I+N-R.fixedBottom-1){var P=T.getNonEmptyRowCount(this)-R.fixedTop-R.fixedBottom;var O=this._getTotalRowCount()-R.fixedBottom-this.getFirstVisibleRow()-P*2;s(this,E,true);if(O<P&&R.fixedBottom>0){T.focusItem(this,J+L*(I+N-G-1),E);}}else{T.focusItem(this,J+L*(I+N-G-1),E);}}}};b.prototype.onsappageupmodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(E,null,M.ALT)){var i=T.getCellInfo(E.target);var F=T.getFocusedItemInfo(this);if(i.isOfType(C.DATACELL|C.COLUMNHEADER)){var G=F.cell;var I=F.cellInRow;var J=T.hasRowHeader(this);var R=J?1:0;var P=H;p(E);if(J&&(T.Grouping.isInGroupHeaderRow(E.target)||I===1)){T.focusItem(this,G-I,null);}else if(I-R<P){T.focusItem(this,G-I+R,null);}else{T.focusItem(this,G-P,null);}}else if(i.isOfType(C.ROWACTION)){T.focusItem(this,F.cell-1,null);}}};b.prototype.onsappagedownmodifiers=function(E){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(E,null,M.ALT)){var i=T.getCellInfo(E.target);if(i.isOfType(C.DATACELL|C.ROWHEADER|C.ANYCOLUMNHEADER)){var F=T.getFocusedItemInfo(this);var G=F.cellInRow;var I=T.hasRowHeader(this);var R=I?1:0;var V=T.getVisibleColumnCount(this);var J=parseInt(i.cell.attr("colspan")||1);p(E);if(G+J-R<V){var L=F.cell;var P=H;if(I&&G===0){T.focusItem(this,L+1,null);}else if(J>P){T.focusItem(this,L+J,null);}else if(G+J-R+P>V){T.focusItem(this,L+V-G-1+R,null);}else if(!T.Grouping.isInGroupHeaderRow(E.target)){T.focusItem(this,L+P,null);}}else if(i.isOfType(C.DATACELL)&&T.hasRowActions(this)&&G===F.columnCount-2){T.focusItem(this,F.cell+1,null);}}}};b.prototype.onsapenter=function(E){w(this,E);};return b;});
