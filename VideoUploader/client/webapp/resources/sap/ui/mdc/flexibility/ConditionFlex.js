/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/util/merge','sap/ui/mdc/condition/FilterOperatorUtil'],function(m,F){"use strict";var d=function(C){var o=C&&C.getEngine?C.getEngine().getController(C,"Filter"):null;return o?o.getFilterControl():null;};var a=function(C,o,b,p,i){var f=d(b);if(f&&f.applyConditionsAfterChangesApplied){f.applyConditionsAfterChangesApplied();}return new Promise(function(e){var g,h=null,M=p.modifier;g=m({},M.getProperty(b,"filterConditions"));if(g){for(var s in g){if(s===o.name){h=g[s];break;}}}if(!h){g[o.name]=[];h=g[o.name];}var n=F.indexOfCondition(o.condition,h);if(n<0){h.push(o.condition);M.setProperty(b,"filterConditions",g);if(!i){C.setRevertData({name:o.name,condition:o.condition});}if(f&&f.addCondition){f.addCondition(o.name,o.condition).then(function(){e();});}else{e();}}else{e();}});};var r=function(C,o,b,p,i){var f=d(b);if(f&&f.applyConditionsAfterChangesApplied){f.applyConditionsAfterChangesApplied();}return new Promise(function(e){var g,h,n=-1,M=p.modifier;g=m({},M.getProperty(b,"filterConditions"));if(g){for(var s in g){if(s===o.name){h=g[s];break;}}}if(h&&(h.length>0)){n=F.indexOfCondition(o.condition,h);if(n>=0){h.splice(n,1);M.setProperty(b,"filterConditions",g);if(!i){C.setRevertData({name:o.name,condition:o.condition});}if(f&&f.removeCondition){f.removeCondition(o.name,o.condition).then(function(){e();});}else{e();}}else{e();}}else{e();}});};var c={};c.addCondition={"changeHandler":{applyChange:function(C,o,p){return a(C,C.getContent(),o,p,false);},completeChangeContent:function(C,b,p){},revertChange:function(C,o,p){return r(C,C.getRevertData(),o,p,true).then(function(){C.resetRevertData();});}},"layers":{"USER":true}};c.removeCondition={"changeHandler":{applyChange:function(C,o,p){return r(C,C.getContent(),o,p,false);},completeChangeContent:function(C,b,p){},revertChange:function(C,o,p){return a(C,C.getRevertData(),o,p,true).then(function(){C.resetRevertData();});}},"layers":{"USER":true}};return c;});
