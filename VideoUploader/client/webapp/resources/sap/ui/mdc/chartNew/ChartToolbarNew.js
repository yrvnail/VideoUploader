/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/mdc/library","sap/ui/mdc/ActionToolbar","sap/m/OverflowToolbarRenderer","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/Title","sap/ui/mdc/library","sap/ui/mdc/chartNew/ChartTypeButtonNew","sap/ui/mdc/chart/ChartSettings","./ChartSelectionDetailsNew"],function(C,a,A,O,b,c,T,M,d,e,f){"use strict";var g=A.extend("sap.ui.mdc.chartNew.ChartToolbarNew",{metadata:{library:"sap.ui.mdc",interfaces:[],defaultAggregation:"",properties:{},aggregations:{},associations:{},events:{}},renderer:O});var h=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");g.prototype.init=function(){A.prototype.init.apply(this,arguments);};g.prototype.createToolbarContent=function(m){var t=new T(m.getId()+"-title",{text:m.getHeader()});this.addBegin(t);this._oChartSelectionDetails=new f(m.getId()+"-selectionDetails",{});this._oChartSelectionDetails.attachBeforeOpen(function(E){this._updateSelectionDetailsActions(m);}.bind(this));this.addEnd(this._oChartSelectionDetails);if(!m.getIgnoreToolbarActions().length||m.getIgnoreToolbarActions().indexOf(M.ChartToolbarActionType.DrillDownUp)<0){this._oDrillDownBtn=new b(m.getId()+"-drillDown",{icon:"sap-icon://drill-down",press:function(E){m._showDrillDown(this._oDrillDownBtn);}.bind(this),enabled:false});this.addEnd(this._oDrillDownBtn);}if(!m.getIgnoreToolbarActions().length||m.getIgnoreToolbarActions().indexOf(M.ChartToolbarActionType.Legend)<0){this._oLegendBtn=new c(m.getId()+"btnLegend",{type:"Transparent",text:h.getText("chart.LEGENDBTN_TEXT"),tooltip:h.getText("chart.LEGENDBTN_TOOLTIP"),icon:"sap-icon://legend",pressed:"{$mdcChart>/legendVisible}",enabled:false});this.addEnd(this._oLegendBtn);}if(!m.getIgnoreToolbarActions().length||m.getIgnoreToolbarActions().indexOf(M.ChartToolbarActionType.ZoomInOut)){this.oZoomInButton=new b(m.getId()+"btnZoomIn",{icon:"sap-icon://zoom-in",enabled:false,press:function i(o){m.zoomIn();this.toggleZoomButtons(m);}.bind(this)});this.oZoomOutButton=new b(m.getId()+"btnZoomOut",{icon:"sap-icon://zoom-out",enabled:false,press:function i(o){m.zoomOut();this.toggleZoomButtons(m);}.bind(this)});this.addEnd(this.oZoomInButton);this.addEnd(this.oZoomOutButton);}var p=m.getP13nMode()||[];if(p.indexOf("Item")>-1){this._oSettingsBtn=new b(m.getId()+"-chart_settings",{icon:"sap-icon://action-settings",enabled:false,press:function(E){var s=E.getSource();e.showPanel(m,"Chart",s);}});this.addEnd(this._oSettingsBtn);}if(p.indexOf("Sort")>-1){this._oSortBtn=new b(m.getId()+"-sort_settings",{icon:"sap-icon://sort",press:function(E){var s=E.getSource();e.showPanel(m,"Sort",s,m._getPropertyData());},enabled:false});this.addEnd(this._oSortBtn);}if(p.indexOf("Type")>-1){this._oChartTypeBtn=new d(m);this._oChartTypeBtn.setEnabled(false);this.addEnd(this._oChartTypeBtn);}};g.prototype.toggleZoomButtons=function(m){var z=this._getZoomEnablement(m);if(z.enabled){this.oZoomInButton.setEnabled(z.enabledZoomIn);this.oZoomOutButton.setEnabled(z.enabledZoomOut);}else{this.oZoomInButton.setEnabled(false);this.oZoomOutButton.setEnabled(false);}};g.prototype.updateToolbar=function(m){this.toggleZoomButtons(m);if(!this._toolbarInitialUpdated){this._enableToolbarButtons();this._toolbarInitialUpdated=true;}var s=m.getSelectionHandler();this._oChartSelectionDetails.attachSelectionHandler(s.eventId,s.listener);};g.prototype._enableToolbarButtons=function(){if(this._oLegendBtn){this._oLegendBtn.setEnabled(true);}if(this._oChartTypeBtn){this._oChartTypeBtn.setEnabled(true);}if(this._oSettingsBtn){this._oSettingsBtn.setEnabled(true);}if(this._oSortBtn){this._oSortBtn.setEnabled(true);}if(this._oDrillDownBtn){this._oDrillDownBtn.setEnabled(true);}};g.prototype._getZoomEnablement=function(m){var z=m.getZoomState();if(z&&z.hasOwnProperty("currentZoomLevel")&&z.currentZoomLevel!=null&&z.enabled){var t={enabled:true};t.enabledZoomOut=z.currentZoomLevel>0;t.enabledZoomIn=z.currentZoomLevel<1;return t;}else{return{enabled:false};}};g.prototype._updateSelectionDetailsActions=function(m){var s=m.getSelectionDetailsActions(),o;if(s){var S=this._oChartSelectionDetails.getItems();S.forEach(function(I){var j=s.getDetailsItemActions();j.forEach(function(k){o=k.clone();I.addAction(o);});});var D=s.getDetailsActions();this._oChartSelectionDetails.removeAllActions();D.forEach(function(j){o=j.clone();this._oChartSelectionDetails.addAction(o);}.bind(this));var i=s.getActionGroups();this._oChartSelectionDetails.removeAllActionGroups();i.forEach(function(j){o=j.clone();this._oChartSelectionDetails.addActionGroup(o);}.bind(this));}};return g;},true);
