/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./TableTypeBase","../library"],function(T,l){"use strict";var I,a,b,c,d,e,f,g;var R=l.RowCountMode;var h=l.RowAction;var G=T.extend("sap.ui.mdc.table.GridTableType",{metadata:{library:"sap.ui.mdc",properties:{rowCountMode:{type:"sap.ui.mdc.RowCountMode",defaultValue:R.Auto},rowCount:{type:"int",defaultValue:10},selectionLimit:{type:"int",defaultValue:200},showHeaderSelector:{type:"boolean",defaultValue:true}}}});G.prototype.updateRelevantTableProperty=function(t,p,v){if(!t||!t.isA("sap.ui.table.Table")){return;}if(p==="rowCountMode"){var r=t.getRowMode();var H=false;if(r&&(v===R.Fixed&&!r.isA("sap.ui.table.rowmodes.FixedRowMode")||v===R.Auto&&!r.isA("sap.ui.table.rowmodes.AutoRowMode"))){H=r.getHideEmptyRows();r.destroy();r=null;}if(!r){var i=v===R.Fixed?e:f;t.setRowMode(new i({hideEmptyRows:H}));}this._updateTableRowCount(t,v,this.getRowCount());}else if(p==="rowCount"){this._updateTableRowCount(t,this.getRowCountMode(),v);}else if(p==="selectionLimit"){t.getPlugins()[0].setLimit(v).setEnableNotification(v>0);}else if(p==="showHeaderSelector"){t.getPlugins()[0].setShowHeaderSelector(v);}};G.prototype._updateTableRowCount=function(t,m,v){if(m===R.Fixed){t.getRowMode().setRowCount(v);}else{t.getRowMode().setMinRowCount(v);}};G.updateDefault=function(t){if(t){t.setRowMode(new f({minRowCount:10}));}};G.loadGridTableLib=function(){if(!this._oGridTableLibLoaded){this._oGridTableLibLoaded=sap.ui.getCore().loadLibrary("sap.ui.table",true);}return this._oGridTableLibLoaded;};G.loadTableModules=function(){if(!I){return new Promise(function(r,i){this.loadGridTableLib().then(function(){sap.ui.require(["sap/ui/table/Table","sap/ui/table/Column","sap/ui/table/RowAction","sap/ui/table/RowActionItem","sap/ui/table/plugins/MultiSelectionPlugin","sap/ui/table/rowmodes/FixedRowMode","sap/ui/table/rowmodes/AutoRowMode","sap/ui/table/RowSettings"],function(j,k,h,m,M,F,A,n){I=j;a=k;b=h;c=m;d=M;e=F;f=A;g=n;r();},function(){i("Failed to load some modules");});});}.bind(this));}else{return Promise.resolve();}};G.createTable=function(i,s){return new I(i,s);};G.createColumn=function(i,s){var C=new a(i,s);C.attachColumnMenuOpen(function(E){E.preventDefault();});C._menuHasItems=function(){return true;};return C;};G.createNavigationRowAction=function(i,E){return new b(i+"--rowAction",{items:new c(i+"--rowActionItem",{type:h.Navigation,press:E})});};G.createMultiSelectionPlugin=function(t,E){return new d(t.getId()+"--multiSelectPlugin",{selectionMode:T.getSelectionMode(t),selectionChange:E});};G.enableColumnResizer=function(i){i.getColumns().forEach(function(C){C.setResizable(true);C.setAutoResizable(true);});};G.disableColumnResizer=function(i){i.getColumns().forEach(function(C){C.setResizable(false);C.setAutoResizable(false);});};G.updateSelection=function(t){var s=T.getSelectionMode(t);t._oTable.getPlugins()[0].setSelectionMode(s);};G.updateNavigation=function(t,r){t._oTable.setRowActionTemplate(this.createNavigationRowAction(t.getId(),[r,t]));t._oTable.setRowActionCount(1);};G.clearNavigation=function(t){var i=t._oTable.getRowActionTemplate();if(i){i.destroy();}t._oTable.setRowActionTemplate();t._oTable.setRowActionCount();};G.updateRowAction=function(t,n,r){this.clearNavigation(t);if(n){this.updateNavigation(t,r);}};G.updateRowSettings=function(t,r){var i=new g(undefined,r.getAllSettings());t.getRowSettingsTemplate().destroy();t.setRowSettingsTemplate(i);};return G;});
